<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì´ˆê³ ë‚œë„ í™•ì¥íŒ ì•”ì‚° í€´ì¦ˆ</title>

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #6a0571; /* ë³´ë¼ìƒ‰ ê³„ì—´ */
            --secondary-color: #ab2a9c; /* ì•½ê°„ ë°ì€ ë³´ë¼ìƒ‰ */
            --accent-color: #ff6f61; /* ê°•ì¡°ìƒ‰ (ì£¼í™©-ë¹¨ê°•) */
            --text-color: #333;
            --light-bg: #f9f7fb;
            --dark-bg: #e0e0e0; /* ì—°í•œ íšŒìƒ‰ ë°°ê²½ */
            --card-bg: #ffffff;
            --border-color: #ddd;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --info-color: #007bff;
        }

        body {
            font-family: 'Poppins', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #f0f4f8, #d9e2ec); /* ë¶€ë“œëŸ¬ìš´ ê·¸ë¼ë°ì´ì…˜ ë°°ê²½ */
            transition: background-color 0.2s ease-in-out;
            color: var(--text-color);
            line-height: 1.6;
        }
        
        /* ğŸš¨ ê¹œë¹¡ì„ ê²½ê³  CSS í´ë˜ìŠ¤ */
        .flash-warning {
            background-color: #ffe0e0 !important; /* ë°ì€ ë¹¨ê°•ìœ¼ë¡œ ê¹œë¹¡ì„ */
        }

        .quiz-container {
            width: 90%;
            max-width: 500px; /* ìµœëŒ€ ë„ˆë¹„ ì¦ê°€ */
            text-align: center;
            background: var(--card-bg);
            padding: 45px; /* íŒ¨ë”© ì¦ê°€ */
            border-radius: 20px; /* ë” ë‘¥ê·¼ ëª¨ì„œë¦¬ */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); /* ë” ê¹Šì€ ê·¸ë¦¼ì */
            z-index: 10;
            position: relative;
            overflow: hidden; /* ìš”ì†Œ ë°–ìœ¼ë¡œ ë„˜ì¹˜ëŠ” ê·¸ë¦¼ì ë°©ì§€ */
        }

        /* ì»¨í…Œì´ë„ˆ ìƒë‹¨ì— ê°€ìƒ ìš”ì†Œë¡œ ê°•ì¡° ë¼ì¸ ì¶”ê°€ */
        .quiz-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 8px;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            border-top-left-radius: 20px;
            border-top-right-radius: 20px;
        }

        h1 {
            color: var(--primary-color);
            margin-top: 0;
            font-size: 2.2em; /* í°íŠ¸ í¬ê¸° ì¦ê°€ */
            font-weight: 700;
            margin-bottom: 10px;
        }

        .quiz-container > p { /* "5ë¬¸ì œ ë„ì „!" ì„¤ëª… ë¬¸êµ¬ ìŠ¤íƒ€ì¼ */
            font-size: 1.05em;
            color: #666;
            margin-bottom: 25px;
        }

        /* í—¤ë” (ë¬¸ì œ, ì •ë‹µ, ì‹œê°„, ìµœê³ ê¸°ë¡) */
        .header {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* 2ì—´ ê·¸ë¦¬ë“œ */
            gap: 15px; /* ê°„ê²© ì¦ê°€ */
            margin-bottom: 35px;
            font-size: 0.95em;
            font-weight: 600;
        }

        .header > div {
            padding: 12px 10px; /* íŒ¨ë”© ì¦ê°€ */
            border-radius: 10px; /* ë” ë‘¥ê·¼ ëª¨ì„œë¦¬ */
            display: flex; /* ë‚´ë¶€ í…ìŠ¤íŠ¸ ì¤‘ì•™ ì •ë ¬ */
            justify-content: center;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05); /* ì‘ì€ ê·¸ë¦¼ì */
        }

        #q-count {
            background-color: var(--info-color);
            color: white;
        }

        #correct-count {
            background-color: var(--success-color);
            color: white;
        }
        
        #q-timer {
            background-color: var(--warning-color);
            color: var(--text-color); /* í…ìŠ¤íŠ¸ ìƒ‰ìƒ ë³€ê²½ */
            transition: background-color 0.3s ease-in-out;
        }

        #high-score {
            background: linear-gradient(to right, #6f42c1, #a750d8); /* ê·¸ë¼ë°ì´ì…˜ ë°°ê²½ */
            color: white;
            grid-column: 1 / -1; /* ì „ì²´ ë„ˆë¹„ ì°¨ì§€ */
        }
        
        #problem {
            font-size: 4em; /* ë¬¸ì œ í°íŠ¸ í¬ê¸° ë” í‚¤ì›€ */
            font-weight: 700;
            margin: 40px 0; /* ì—¬ë°± ì¦ê°€ */
            color: var(--primary-color);
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.05); /* í…ìŠ¤íŠ¸ ê·¸ë¦¼ì */
        }

        #answer {
            width: 70%; /* ë„ˆë¹„ ì¡°ì • */
            padding: 18px; /* íŒ¨ë”© ì¦ê°€ */
            font-size: 2em; /* í°íŠ¸ í¬ê¸° ì¦ê°€ */
            text-align: center;
            border: 3px solid var(--primary-color); /* í…Œë‘ë¦¬ ìƒ‰ìƒ ê°•ì¡° */
            border-radius: 12px; /* ë” ë‘¥ê·¼ ëª¨ì„œë¦¬ */
            margin-bottom: 15px;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1); /* ë‚´ë¶€ ê·¸ë¦¼ì */
            transition: border-color 0.3s ease-in-out;
        }
        #answer:focus {
            outline: none;
            border-color: var(--accent-color); /* í¬ì»¤ìŠ¤ ì‹œ ê°•ì¡°ìƒ‰ */
            box-shadow: 0 0 0 3px rgba(255, 111, 97, 0.3); /* í¬ì»¤ìŠ¤ ì‹œ ì™¸ê³½ì„  ê·¸ë¦¼ì */
        }
        
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        #message {
            margin-top: 25px; /* ì—¬ë°± ì¦ê°€ */
            font-size: 1.25em; /* í°íŠ¸ í¬ê¸° ì¦ê°€ */
            height: 35px; /* ë†’ì´ ê³ ì • */
            font-weight: 600;
        }

        .correct {
            color: var(--success-color);
        }

        .wrong {
            color: var(--danger-color);
        }

        #startBtn {
            width: 100%;
            padding: 20px; /* íŒ¨ë”© ì¦ê°€ */
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color)); /* ê·¸ë¼ë°ì´ì…˜ */
            color: white;
            border: none;
            border-radius: 12px; /* ë” ë‘¥ê·¼ ëª¨ì„œë¦¬ */
            cursor: pointer;
            font-size: 1.4em; /* í°íŠ¸ í¬ê¸° ì¦ê°€ */
            font-weight: 600;
            margin-top: 40px; /* ì—¬ë°± ì¦ê°€ */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2); /* ì…ì²´ê° ìˆëŠ” ê·¸ë¦¼ì */
            transition: all 0.3s ease; /* ë¶€ë“œëŸ¬ìš´ ì „í™˜ íš¨ê³¼ */
            letter-spacing: 1px; /* ìê°„ ì¡°ì • */
        }

        #startBtn:hover {
            transform: translateY(-3px); /* ì•½ê°„ ìœ„ë¡œ ë– ì˜¤ë¥´ëŠ” íš¨ê³¼ */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3); /* ê·¸ë¦¼ì ê°•í™” */
            opacity: 0.9;
        }

        #startBtn:active {
            transform: translateY(0);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body>

<div class="quiz-container">
    <h1>ğŸ”¥ ì´ˆê³ ì† ì•”ì‚° ë„ì „</h1>
    <p>ì‚¬ì¹™ì—°ì‚°, ê±°ë“­ì œê³±, ì œê³±ê·¼ í¬í•¨! 10ë¬¸ì œ ë„ì „!</p>

    <div class="header">
        <div id="q-count">ë¬¸ì œ: 0 / 10</div> <div id="correct-count">ì •ë‹µ: 0</div>
        <div id="q-timer">ì œí•œ: 10ì´ˆ</div>
        <div id="high-score">ìµœê³  ê¸°ë¡: 0%</div>
    </div>

    <div id="problem">ì‹œì‘ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”</div>
    
    <input type="number" id="answer" placeholder="ì •ë‹µ ì…ë ¥ í›„ Enter" disabled>
    
    <p id="message"></p>

    <button id="startBtn">ë„ì „ ì‹œì‘</button>
</div>

<script>
    // DOM ìš”ì†Œ
    const qCountEl = document.getElementById('q-count');
    const correctCountEl = document.getElementById('correct-count');
    const qTimerEl = document.getElementById('q-timer');
    const highScoreEl = document.getElementById('high-score');
    const problemEl = document.getElementById('problem');
    const answerInput = document.getElementById('answer');
    const messageEl = document.getElementById('message');
    const startBtn = document.getElementById('startBtn');

    // ê²Œì„ ìƒíƒœ ë³€ìˆ˜ ë° ìƒìˆ˜
    const HIGH_SCORE_KEY = 'arithmeticHighScore';
    let currentQuestion = 0;
    let correctAnswers = 0;
    let currentCorrectAnswer = 0;
    const TOTAL_QUESTIONS = 10; // ğŸš¨ ì´ ë¬¸ì œ ìˆ˜ 10ìœ¼ë¡œ ë³€ê²½
    const OPERATORS = ['+', '-', 'Ã—', 'Ã·', '^', 'âˆš']; 
    
    const TIME_LIMIT_PER_Q = 10; 
    let questionTimeLeft; 
    let questionTimerInterval;
    let flashInterval; 

    // --- ì´ˆê¸°í™” ë° ìµœê³  ê¸°ë¡ ë¡œë“œ ---

    function loadHighScore() {
        const storedScore = localStorage.getItem(HIGH_SCORE_KEY) || 0;
        highScoreEl.textContent = `ìµœê³  ê¸°ë¡: ${storedScore}%`;
    }

    loadHighScore();

    function getRandomNumber() {
        return Math.floor(Math.random() * 900) + 100; // 100 ~ 999
    }
    
    // --- ê²Œì„ íë¦„ ì œì–´ ---

    function startGame() {
        if (questionTimerInterval) {
            clearInterval(questionTimerInterval);
        }
        if (flashInterval) { 
            clearInterval(flashInterval);
            document.body.classList.remove('flash-warning');
        }
        
        currentQuestion = 0;
        correctAnswers = 0;
        qCountEl.textContent = `ë¬¸ì œ: 0 / ${TOTAL_QUESTIONS}`;
        correctCountEl.textContent = "ì •ë‹µ: 0";
        qTimerEl.textContent = `ì œí•œ: ${TIME_LIMIT_PER_Q}ì´ˆ`;
        qTimerEl.style.backgroundColor = 'var(--warning-color)'; /* CSS ë³€ìˆ˜ ì‚¬ìš© */
        messageEl.textContent = "";
        
        startBtn.style.display = 'none'; 
        answerInput.disabled = false;
        answerInput.value = '';
        
        nextQuestion();
        answerInput.focus();
    }
    
    function startQuestionTimer() {
        if (questionTimerInterval) {
            clearInterval(questionTimerInterval);
        }
        if (flashInterval) {
            clearInterval(flashInterval);
            document.body.classList.remove('flash-warning');
        }
        
        questionTimeLeft = TIME_LIMIT_PER_Q;
        qTimerEl.textContent = `ì œí•œ: ${questionTimeLeft}ì´ˆ`;
        qTimerEl.style.backgroundColor = 'var(--warning-color)'; /* CSS ë³€ìˆ˜ ì‚¬ìš© */

        questionTimerInterval = setInterval(() => {
            questionTimeLeft--;
            qTimerEl.textContent = `ì œí•œ: ${questionTimeLeft}ì´ˆ`;
            
            if (questionTimeLeft === 5) {
                qTimerEl.style.backgroundColor = 'var(--danger-color)'; /* CSS ë³€ìˆ˜ ì‚¬ìš© */
                
                flashInterval = setInterval(() => {
                    document.body.classList.toggle('flash-warning');
                }, 200); 
            }

            if (questionTimeLeft <= 3 && questionTimeLeft > 0) { 
                qTimerEl.style.backgroundColor = 'var(--danger-color)'; /* CSS ë³€ìˆ˜ ì‚¬ìš© */
            }

            if (questionTimeLeft <= 0) {
                clearInterval(questionTimerInterval);
                clearInterval(flashInterval);
                document.body.classList.remove('flash-warning');
                handleTimeUp();
            }
        }, 1000);
    }

    function handleTimeUp() {
        answerInput.disabled = true;
        messageEl.textContent = `â° ì‹œê°„ ì´ˆê³¼! (ì •ë‹µ: ${currentCorrectAnswer})`;
        messageEl.className = 'wrong';
        
        setTimeout(() => {
            answerInput.disabled = false;
            nextQuestion();
            answerInput.focus();
        }, 800);
    }
    
    function nextQuestion() {
        if (currentQuestion >= TOTAL_QUESTIONS) {
            endGame();
            return;
        }
        
        currentQuestion++;
        qCountEl.textContent = `ë¬¸ì œ: ${currentQuestion} / ${TOTAL_QUESTIONS}`;

        startQuestionTimer(); 

        generateProblem();
    }

    // --- ë¬¸ì œ ìƒì„± í•¨ìˆ˜ ---

    function generateProblem() {
        let num1, num2, operator, result;
        
        // ì—°ì‚°ì ë¹„ì¤‘ ì¡°ì ˆ (ì˜ˆ: ì‚¬ì¹™ì—°ì‚° ë¹„ì¤‘ì„ ë†’ì´ê³  íŠ¹ìˆ˜ ì—°ì‚° ë¹„ì¤‘ì„ ë‚®ì¶¤)
        const weightedOperators = ['+', '-', 'Ã—', 'Ã·', '+', '-', 'Ã—', '^', 'âˆš']; 
        operator = weightedOperators[Math.floor(Math.random() * weightedOperators.length)];

        if (operator === '+') {
            num1 = getRandomNumber();
            num2 = getRandomNumber();
            result = num1 + num2;
            problemEl.textContent = `${num1} + ${num2} =`;
            
        } else if (operator === '-') {
            num1 = getRandomNumber();
            num2 = getRandomNumber();
            let temp = Math.max(num1, num2);
            num2 = Math.min(num1, num2);
            num1 = temp;
            result = num1 - num2;
            problemEl.textContent = `${num1} - ${num2} =`;
            
        } else if (operator === 'Ã—') {
            num1 = Math.floor(Math.random() * 90) + 10;
            num2 = Math.floor(Math.random() * 15) + 2;  
            result = num1 * num2;
            problemEl.textContent = `${num1} Ã— ${num2} =`;
            
        } else if (operator === 'Ã·') {
            let quotient = Math.floor(Math.random() * 90) + 10;
            num2 = Math.floor(Math.random() * 15) + 2;
            num1 = quotient * num2;
            result = quotient;
            problemEl.textContent = `${num1} Ã· ${num2} =`;
            
        } else if (operator === '^') {
            num1 = Math.floor(Math.random() * 9) + 2; 
            num2 = Math.random() > 0.5 ? 2 : 3; 
            result = Math.pow(num1, num2);
            problemEl.textContent = `${num1} ^ ${num2} =`;
            
        } else if (operator === 'âˆš') {
            const MIN_ROOT = 4;
            const MAX_ROOT = 31; 
            const range = MAX_ROOT - MIN_ROOT + 1;

            result = Math.floor(Math.random() * range) + MIN_ROOT; 
            num1 = result * result;
            problemEl.textContent = `âˆš${num1} =`; 
        }

        currentCorrectAnswer = result;
        answerInput.value = ''; 
        messageEl.textContent = ''; 
    }

    // --- ì •ë‹µ í™•ì¸ ë° ì¢…ë£Œ ---

    function checkAnswer(event) {
        if (event.key === 'Enter') {
            clearInterval(questionTimerInterval); 
            if (flashInterval) {
                clearInterval(flashInterval);
                document.body.classList.remove('flash-warning');
            }
            qTimerEl.style.backgroundColor = 'var(--warning-color)'; /* CSS ë³€ìˆ˜ ì‚¬ìš© */
            
            const userAnswer = parseInt(answerInput.value);

            if (isNaN(userAnswer)) {
                messageEl.textContent = "ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”!";
                messageEl.className = 'wrong';
                setTimeout(() => {
                    nextQuestion(); 
                }, 500);
                return;
            }

            if (userAnswer === currentCorrectAnswer) {
                correctAnswers++;
                messageEl.textContent = "â­ï¸ ì •ë‹µ!";
                messageEl.className = 'correct';
            } else {
                messageEl.textContent = `âŒ ì˜¤ë‹µ! (ì •ë‹µ: ${currentCorrectAnswer})`;
                messageEl.className = 'wrong';
            }
            
            correctCountEl.textContent = `ì •ë‹µ: ${correctAnswers}`;
            
            answerInput.disabled = true; 
            setTimeout(() => {
                answerInput.disabled = false;
                nextQuestion();
                answerInput.focus();
            }, 800);
        }
    }

    function endGame() {
        if (questionTimerInterval) {
            clearInterval(questionTimerInterval);
        }
        if (flashInterval) { 
            clearInterval(flashInterval);
            document.body.classList.remove('flash-warning');
        }
        answerInput.disabled = true;
        
        const percentage = Math.round((correctAnswers / TOTAL_QUESTIONS) * 100);

        problemEl.textContent = "ë„ì „ ì™„ë£Œ!";
        messageEl.textContent = `ìµœì¢… ì •ë‹µë¥ : ${percentage}% (${correctAnswers} / ${TOTAL_QUESTIONS} ë¬¸ì œ)`;
        messageEl.style.color = percentage >= 80 ? 'var(--info-color)' : 'var(--danger-color)';
        
        const currentHighScore = parseInt(localStorage.getItem(HIGH_SCORE_KEY) || 0);
        if (percentage > currentHighScore) {
            localStorage.setItem(HIGH_SCORE_KEY, percentage);
            highScoreEl.textContent = `ğŸ‰ ìµœê³  ê¸°ë¡: ${percentage}%`;
            messageEl.textContent += " (NEW RECORD!)";
        }
        
        startBtn.textContent = "ë‹¤ì‹œ ë„ì „í•˜ê¸°";
        startBtn.style.display = 'block'; 
        qTimerEl.textContent = `ì œí•œ: ${TIME_LIMIT_PER_Q}ì´ˆ`; 
    }

    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²°
    startBtn.addEventListener('click', startGame);
    answerInput.addEventListener('keypress', checkAnswer);

</script>

</body>
</html>